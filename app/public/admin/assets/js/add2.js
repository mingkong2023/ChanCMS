import{n as H,m as J,r as X,N as Y,s as h,L as ee,M as le,C as ae,B as te,g as oe,q as se,a as b}from"./element-plus.js";import{r as u,W as re,n as de,c as y,o as p,a as f,O as t,L as s,T as w,I as _,ac as U,K as E,a3 as n,U as x,Q as ue}from"./@vue.js";import{u as ne}from"./vue-router.js";import{v as me}from"./sys_config.js";import{f as ie,c as pe}from"./category.js";import{a as Ve,t as fe,b as ve}from"./index.js";import{l as be}from"./model.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const ye={class:"bg-fff radius-6 pd-20"},ge={class:"mr-10 ml-10"},ce={class:"mr-10 ml-10 mb-20"},Ze={__name:"add",setup(we){const D=ne(),k=u(null),S=u([]),V=u(""),I={checkStrictly:!0},B=u("first"),v=u(0),C=u([]),g=u([]),T=u([]),c=u([]),a=re({pid:0,seoTitle:"",seoKeywords:"",seoDescription:"",name:"",path:"",pinyin:"",mid:0,description:"",url:"",orderBy:0,type:0,target:0,status:0,articleView:"article.html",listView:"list.html"}),N=o=>{a.path=V.value?V.value+o:"/"+V.value+o},K=o=>{v.value=parseInt(o.index)},O=async()=>{try{const o=await ie();if(o.code===200){g.value=o.data;const e=Ve(fe(o.data));C.value=e}}catch(o){console.log(o)}},P=async()=>{try{const o=await me();o.code===200&&(c.value=o.data.filter(e=>!["404.html","500.html"].includes(e)).map(e=>({label:e,value:e})))}catch(o){console.log(o)}},q=o=>{console.log(o,g.value);let e=Object.values(o).at(-1);g.value.forEach(m=>{m.id===e&&(V.value=m.path+"/")}),a.path=V.value+a.pinyin,o[0]!==-1&&(console.log("params.pid",o[o.length-1]),a.pid=o[o.length-1])},A=async()=>{try{const o=await be();o.code===200&&(T.value=o.data.list)}catch(o){console.log(o)}},F=async()=>{try{const o=await pe(a);o.code===200?(b({message:"更新成功^_^",type:"success"}),D.go(-1)):b({message:o.msg,type:"error"})}catch(o){console.log(o)}},M=()=>a.pinyin==="article"?(b({message:"不能使用article作为拼音",type:"error"}),!1):/^[a-zA-Z][a-zA-Z0-9]*$/.test(a.pinyin)?!0:(b({message:"拼音只能包含26个字母和数字，且首字母不能是数字",type:"error"}),!1),z=o=>{o.validate((e,m)=>{e?M()&&F():ve(m)})};return de(()=>{O(),P(),A()}),(o,e)=>{const m=H,Z=J,$=Y,r=X,d=h,L=le,R=ee,i=ae,j=te,G=oe,Q=se;return p(),y("div",ye,[f("div",ge,[t(Z,{modelValue:B.value,"onUpdate:modelValue":e[0]||(e[0]=l=>B.value=l),onTabClick:K},{default:s(()=>[t(m,{label:"基本信息",name:"first"}),t(m,{label:"SEO设置",name:"second"}),t(m,{label:"扩展信息",name:"third"})]),_:1},8,["modelValue"])]),f("div",ce,[t(Q,{ref_key:"paramsRef",ref:k,model:a,"label-width":"84px"},{default:s(()=>[w(f("div",null,[t(r,{label:"上级栏目"},{default:s(()=>[t($,{props:I,"show-all-levels":!1,modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=l=>S.value=l),options:C.value,onChange:q,placeholder:"不选择为顶级栏目"},null,8,["modelValue","options"])]),_:1}),t(r,{label:"栏目名称",prop:"name",rules:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:1,max:50,message:"栏目不能超过50个字",trigger:"blur"}]},{default:s(()=>[t(d,{modelValue:a.name,"onUpdate:modelValue":e[2]||(e[2]=l=>a.name=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"栏目标识"},{default:s(()=>[t(d,{modelValue:a.pinyin,"onUpdate:modelValue":e[3]||(e[3]=l=>a.pinyin=l),onChange:N,placeholder:"注：首页请填写home"},null,8,["modelValue"])]),_:1}),t(r,{label:"栏目路径"},{default:s(()=>[t(d,{modelValue:a.path,"onUpdate:modelValue":e[4]||(e[4]=l=>a.path=l),disabled:""},null,8,["modelValue"])]),_:1}),t(r,{label:"列表模板"},{default:s(()=>[t(R,{modelValue:a.listView,"onUpdate:modelValue":e[5]||(e[5]=l=>a.listView=l),placeholder:"Select"},{default:s(()=>[(p(!0),y(_,null,U(c.value,l=>(p(),E(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"内容模板"},{default:s(()=>[t(R,{modelValue:a.articleView,"onUpdate:modelValue":e[6]||(e[6]=l=>a.articleView=l),placeholder:"Select"},{default:s(()=>[(p(!0),y(_,null,U(c.value,l=>(p(),E(L,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"栏目类型"},{default:s(()=>[t(i,{modelValue:a.type,"onUpdate:modelValue":e[7]||(e[7]=l=>a.type=l),label:0},{default:s(()=>e[21]||(e[21]=[n("栏目")])),_:1},8,["modelValue"]),t(i,{modelValue:a.type,"onUpdate:modelValue":e[8]||(e[8]=l=>a.type=l),label:1},{default:s(()=>e[22]||(e[22]=[n("单页")])),_:1},8,["modelValue"])]),_:1}),t(r,{label:"是否显示"},{default:s(()=>[t(i,{modelValue:a.status,"onUpdate:modelValue":e[9]||(e[9]=l=>a.status=l),label:0},{default:s(()=>e[23]||(e[23]=[n("显示")])),_:1},8,["modelValue"]),t(i,{modelValue:a.status,"onUpdate:modelValue":e[10]||(e[10]=l=>a.status=l),label:1},{default:s(()=>e[24]||(e[24]=[n("隐藏")])),_:1},8,["modelValue"])]),_:1})],512),[[x,v.value===0]]),w(f("div",null,[t(r,{label:"seo标题"},{default:s(()=>[t(d,{modelValue:a.seoTitle,"onUpdate:modelValue":e[11]||(e[11]=l=>a.seoTitle=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"seo关键词"},{default:s(()=>[t(d,{modelValue:a.seoKeywords,"onUpdate:modelValue":e[12]||(e[12]=l=>a.seoKeywords=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"seo描述"},{default:s(()=>[t(d,{type:"textarea",prop:"textarea",rows:2,modelValue:a.seoDescription,"onUpdate:modelValue":e[13]||(e[13]=l=>a.seoDescription=l)},null,8,["modelValue"])]),_:1})],512),[[x,v.value===1]]),w(f("div",null,[t(r,{label:"栏目链接"},{default:s(()=>[t(d,{modelValue:a.url,"onUpdate:modelValue":e[14]||(e[14]=l=>a.url=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"扩展模型"},{default:s(()=>[t(j,{modelValue:a.mid,"onUpdate:modelValue":e[15]||(e[15]=l=>a.mid=l)},{default:s(()=>[t(i,{label:0},{default:s(()=>e[25]||(e[25]=[n("基本模型")])),_:1}),(p(!0),y(_,null,U(T.value,(l,W)=>(p(),E(i,{key:W,label:l.id},{default:s(()=>[n(ue(l.model),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"打开方式"},{default:s(()=>[t(i,{modelValue:a.target,"onUpdate:modelValue":e[16]||(e[16]=l=>a.target=l),label:0},{default:s(()=>e[26]||(e[26]=[n("当前页面")])),_:1},8,["modelValue"]),t(i,{modelValue:a.target,"onUpdate:modelValue":e[17]||(e[17]=l=>a.target=l),label:1},{default:s(()=>e[27]||(e[27]=[n("新页面")])),_:1},8,["modelValue"])]),_:1}),t(r,{label:"栏目排序"},{default:s(()=>[t(d,{modelValue:a.orderBy,"onUpdate:modelValue":e[18]||(e[18]=l=>a.orderBy=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"栏目描述"},{default:s(()=>[t(d,{type:"textarea",prop:"textarea",rows:2,modelValue:a.description,"onUpdate:modelValue":e[19]||(e[19]=l=>a.description=l)},null,8,["modelValue"])]),_:1})],512),[[x,v.value===2]]),t(r,null,{default:s(()=>[t(G,{type:"primary",onClick:e[20]||(e[20]=l=>z(k.value))},{default:s(()=>e[28]||(e[28]=[n("保存")])),_:1})]),_:1})]),_:1},8,["model"])])])}}};export{Ze as default};
