import{q as R,r as U,s as F,L as O,M as j,B as z,C as T,g as q,D as G,a as _}from"./element-plus.js";import{r as A,e as K,W,w as H,K as B,o as g,L as s,O as r,c as J,I as Q,ac as X,a3 as f,a as Y,P as Z}from"./@vue.js";import{h as d,A as n,_ as ee}from"./index.js";let te=(o={})=>d({url:"".concat(n.BASE_API,"/base/role/list"),method:"get",params:o}),pe=(o={})=>d({url:"".concat(n.BASE_API,"/base/user/list"),method:"get",params:o}),le=(o={})=>d({url:"".concat(n.BASE_API,"/base/user/create"),method:"post",data:o}),oe=(o={})=>d({url:"".concat(n.BASE_API,"/base/user/detail"),method:"get",params:o}),ae=(o={})=>d({url:"".concat(n.BASE_API,"/base/userRole/detail"),method:"get",params:o}),se=(o={})=>d({url:"".concat(n.BASE_API,"/base/user/update"),method:"post",data:o}),ce=(o={})=>d({url:"".concat(n.BASE_API,"/base/user/delete"),method:"get",params:o});const re={class:"dialog-footer"},de={__name:"dialog",props:{visible:{type:Boolean,default:!1},id:{type:Number,default:0}},emits:["update:visible"],setup(o,{emit:I}){const m=o,b=A(null),p=A(0),y=I,v=K({get:()=>m.visible,set:t=>y("update:visible",t)}),l=W({roleList:[],form:{username:"",password:"",status:"1",role_id:""}});H(()=>m.visible,async t=>{if(t){if(k(),m.id>0){const e=Number(m.id);p.value=e,await x(e),await P(e)}}else V()});const k=async()=>{try{const t=await te();if(t.code===200){let e=t.data.list||[];l.roleList=e}}catch(t){console.log(t)}},P=async t=>{try{let e=await ae({user_id:t});if(e.code==200){let u=e.data.role_id;l.form.role_id=u}}catch(e){console.error(e)}},S=async()=>{try{let t=l.form;const e=await le(t);e.code===200?(_({message:"创建成功 ^_^",type:"success"}),c()):_({message:e.msg,type:"error"})}catch(t){console.log(t)}},$=async()=>{try{let t={userId:p.value,...l.form};const e=await se(t);e.code===200?(_({message:"更新成功 ^_^",type:"success"}),c()):_({message:e.msg,type:"error"})}catch(t){console.log(t)}},x=async t=>{try{let e=await oe({id:t});if(e.code==200){let{username:u,status:i}=e.data;l.form={username:u,password:"",status:i}}}catch(e){console.error(e)}},C=t=>{t&&t.validate(e=>{if(e)p.value==0?S():$();else return console.log("error submit!!"),!1})},c=()=>{y("update:visible",!1),V()},V=()=>{l.form={username:"",password:"",status:"1",role_id:""},p.value=0};return(t,e)=>{const u=F,i=U,D=j,L=O,w=T,h=z,M=R,E=q,N=G;return g(),B(N,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=a=>v.value=a),title:"编辑",onClose:c},{footer:s(()=>[Y("span",re,[r(E,{onClick:Z(c,["stop"])},{default:s(()=>e[8]||(e[8]=[f("取消",-1)])),_:1,__:[8]}),r(E,{type:"primary",onClick:e[4]||(e[4]=a=>C(b.value))},{default:s(()=>e[9]||(e[9]=[f("确定",-1)])),_:1,__:[9]})])]),default:s(()=>[r(M,{model:l.form,ref_key:"formRef",ref:b,"label-width":"84px"},{default:s(()=>[r(i,{label:"用户名",prop:"username"},{default:s(()=>[r(u,{modelValue:l.form.username,"onUpdate:modelValue":e[0]||(e[0]=a=>l.form.username=a),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(i,{label:"密码",prop:"key"},{default:s(()=>[r(u,{modelValue:l.form.password,"onUpdate:modelValue":e[1]||(e[1]=a=>l.form.password=a),placeholder:"请输入密码"},null,8,["modelValue"])]),_:1}),r(i,{label:"角色",prop:"role_id"},{default:s(()=>[r(L,{modelValue:l.form.role_id,"onUpdate:modelValue":e[2]||(e[2]=a=>l.form.role_id=a),"value-key":"id",class:"m-2",placeholder:"请选择角色",size:"large",style:{width:"240px"}},{default:s(()=>[(g(!0),J(Q,null,X(l.roleList,a=>(g(),B(D,{key:a.name,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(i,{label:"状态"},{default:s(()=>[r(h,{modelValue:l.form.status,"onUpdate:modelValue":e[3]||(e[3]=a=>l.form.status=a)},{default:s(()=>[r(w,{label:"显示",value:"1"},{default:s(()=>e[6]||(e[6]=[f("正常",-1)])),_:1,__:[6]}),r(w,{label:"隐藏",value:"2"},{default:s(()=>e[7]||(e[7]=[f("停用",-1)])),_:1,__:[7]})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},ne=ee(de,[["__scopeId","data-v-e594a01c"]]),_e=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));export{ne as D,_e as d,pe as l,ce as r};
