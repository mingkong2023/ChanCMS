import{r as R,s as U,B as q,C as B,g as C,q as h,a as d}from"./element-plus.js";import{u as I,a as F}from"./vue-router.js";import{d as M,h as O,u as T}from"./model.js";import{_ as W}from"./index.js";import{r as _,W as f,n as j,c as D,o as G,O as r,L as a,a3 as n}from"./@vue.js";import"./dayjs.js";import"./ace-builds.js";import"./@element-plus.js";import"./lodash-es.js";import"./@popperjs.js";import"./async-validator.js";import"./@ctrl.js";import"./memoize-one.js";import"./normalize-wheel-es.js";import"./pinia.js";import"./pinia-plugin-persist.js";import"./axios.js";import"./js-cookie.js";import"./nprogress.js";/* empty css     */const L={class:"bg-fff pd-20 radius-6"},S={__name:"edit",setup(z){const b=I(),g=F(),i=_(null),o=f({id:0,old_tableName:"",model:"",tableName:"",remark:"",status:1}),p=_(!1),u=f({model:[{required:!0,message:"请输入模型名称",trigger:"blur"}],tableName:[{required:!0,message:"请输入表名",trigger:"blur"},{validator:V,trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}]});function V(t,e,s){e.startsWith("ext_")?s():s(new Error("表名必须以 ext_ 开头"))}const v=async()=>{try{const t=await M(o.id);if(t.code===200){const e=t.data;e.status=+e.status,Object.assign(o,{...e,old_tableName:e.tableName})}else d.error(t.msg)}catch(t){console.error(t)}},N=async t=>{try{const e=await O(t);e.code===200?p.value=e.data.count>0:d.error(e.msg)}catch(e){console.error(e)}},k=async()=>{try{const t=await T(o);t.code===200?(d.success("更新成功^_^"),b.go(-1)):d.error(t.msg)}catch(t){console.error(t)}},y=()=>{i.value.validate(t=>{if(t)k();else return console.log("error submit!!"),!1})};return j(async()=>{const t=g.params.id;o.id=t,await v(),await N(t)}),(t,e)=>{const s=U,m=R,c=B,x=q,E=C,w=h;return G(),D("div",L,[r(w,{ref_key:"formRef",ref:i,model:o,"label-width":"100px",class:"mt-20"},{default:a(()=>[r(m,{label:"模型名称",prop:"model",rules:u.model},{default:a(()=>[r(s,{modelValue:o.model,"onUpdate:modelValue":e[0]||(e[0]=l=>o.model=l),placeholder:"请输入模型名称"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,{label:"新增表名",prop:"tableName",rules:u.tableName},{default:a(()=>[r(s,{modelValue:o.tableName,"onUpdate:modelValue":e[1]||(e[1]=l=>o.tableName=l),placeholder:"表名称必须ext_开头"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,{label:"是否启用"},{default:a(()=>[r(x,{modelValue:o.status,"onUpdate:modelValue":e[2]||(e[2]=l=>o.status=l)},{default:a(()=>[r(c,{value:1},{default:a(()=>e[4]||(e[4]=[n("开启",-1)])),_:1,__:[4]}),r(c,{disabled:p.value,value:0},{default:a(()=>e[5]||(e[5]=[n("禁用",-1)])),_:1,__:[5]},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),r(m,{label:"备注",prop:"remark",rules:u.remark},{default:a(()=>[r(s,{modelValue:o.remark,"onUpdate:modelValue":e[3]||(e[3]=l=>o.remark=l),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1},8,["rules"]),r(m,null,{default:a(()=>[r(E,{type:"primary",onClick:y},{default:a(()=>e[6]||(e[6]=[n("保存",-1)])),_:1,__:[6]})]),_:1})]),_:1},8,["model"])])}}},ne=W(S,[["__scopeId","data-v-2304e346"]]);export{ne as default};
